{"ast":null,"code":"\"use strict\";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k];}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,\"default\",{enumerable:true,value:v});}:function(o,v){o[\"default\"]=v;});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!==\"default\"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result;};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{\"default\":mod};};Object.defineProperty(exports,\"__esModule\",{value:true});exports.ComponentCompareChangelog=void 0;const react_1=__importStar(require(\"react\"));const component_ui_compare_1=require(\"@teambit/component.ui.compare\");const component_ui_version_block_1=require(\"@teambit/component.ui.version-block\");const component_1=require(\"@teambit/component\");const classnames_1=__importDefault(require(\"classnames\"));const component_compare_changelog_module_scss_1=__importDefault(require(\"./component-compare-changelog.module.scss\"));const orderByDate=(logA,logB)=>{const{date:dateStrB}=logB||{};const{date:dateStrA}=logA||{};const dateA=dateStrA?new Date(parseInt(dateStrA)):new Date();const dateB=dateStrB?new Date(parseInt(dateStrB)):new Date();if(dateA>dateB)return[logA,logB];return[logB,logA];};const getLogsBetweenVersions=(allLogs,baseVersion,compareVersion)=>{const[startingVersion,endingVersion]=orderByDate(baseVersion,compareVersion);const{startingVersionIndex,endingVersionIndex}=allLogs.reduce((accum,next,index)=>{if(next.hash===(startingVersion===null||startingVersion===void 0?void 0:startingVersion.hash)){accum=Object.assign(Object.assign({},accum),{startingVersionIndex:index});}if(next.hash===(endingVersion===null||endingVersion===void 0?void 0:endingVersion.hash)){accum=Object.assign(Object.assign({},accum),{endingVersionIndex:index});}return accum;},{});return allLogs.filter((_,index)=>index>=startingVersionIndex&&index<=endingVersionIndex);};function ComponentCompareChangelog({className}){const component=(0,react_1.useContext)(component_1.ComponentContext);const componentCompareContext=(0,component_ui_compare_1.useComponentCompare)();const{base,compare,logsByVersion}=componentCompareContext||{};const allLogs=(compare===null||compare===void 0?void 0:compare.model.logs)||[];const baseVersionInfo=(base===null||base===void 0?void 0:base.model.version)?logsByVersion===null||logsByVersion===void 0?void 0:logsByVersion.get(base===null||base===void 0?void 0:base.model.version):undefined;const compareVersionInfo=(compare===null||compare===void 0?void 0:compare.model.version)?logsByVersion===null||logsByVersion===void 0?void 0:logsByVersion.get(compare===null||compare===void 0?void 0:compare.model.version):undefined;const logs=(0,react_1.useMemo)(()=>getLogsBetweenVersions(allLogs,baseVersionInfo,compareVersionInfo),[baseVersionInfo,compareVersionInfo]);return react_1.default.createElement(\"div\",{className:(0,classnames_1.default)(component_compare_changelog_module_scss_1.default.changeLogPage,className)},logs.map((snap,index)=>{const isLatest=component.latest===snap.tag||component.latest===snap.hash;const isCurrent=component.version===snap.tag||component.version===snap.hash;return react_1.default.createElement(component_ui_version_block_1.VersionBlock,{isCurrent:isCurrent,isLatest:isLatest,key:index,componentId:component.id.fullName,snap:snap});}));}exports.ComponentCompareChangelog=ComponentCompareChangelog;","map":null,"metadata":{},"sourceType":"module"}